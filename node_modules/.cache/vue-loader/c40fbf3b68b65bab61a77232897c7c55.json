{"remainingRequest":"/home/ash/Documents/cloudrun/second/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ash/Documents/cloudrun/second/frontend/src/views/Project/Settings.vue?vue&type=style&index=0&id=ec60e39a&lang=postcss&scoped=true&","dependencies":[{"path":"/home/ash/Documents/cloudrun/second/frontend/src/views/Project/Settings.vue","mtime":1601936750531},{"path":"/home/ash/Documents/cloudrun/second/frontend/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ash/Documents/cloudrun/second/frontend/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/ash/Documents/cloudrun/second/frontend/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/ash/Documents/cloudrun/second/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ash/Documents/cloudrun/second/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmxhYmVsIHsKICBAYXBwbHkgcGItMiBmb250LW1lZGl1bSB0ZXh0LTEzIHRleHQtdGV4dE1lZGl1bSBibG9jazsKfQoudGlwIHsKICBAYXBwbHkgcHQtMS01IHRleHQtdGV4dE1lZGl1bSB0ZXh0LTEzOwp9Cg=="},{"version":3,"sources":["Settings.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoIA;AACA;AACA;AACA;AACA;AACA","file":"Settings.vue","sourceRoot":"src/views/Project","sourcesContent":["<template>\n  <div class=\"pr-6 py-8 pl-10 h-full w-full flex flex-col\">\n    <j-breadcrumbs :items=\"['Projects', project.name, 'Project Details']\" />\n    <header class=\"mt-3 flex justify-between text-textDarkest\">\n      <div class=\"text-2xl font-medium\">Project Details</div>\n    </header>\n    <form @submit.prevent style=\"max-width:640px\" autocomplete=\"off\" novalidate>\n      <div class=\"pt-5\">\n        <label class=\"label\" for=\"name\">Name</label>\n        <j-input\n          :value=\"projectUpdateDTO.name\"\n          id=\"name\"\n          placeholder=\"Project name\"\n          @input=\"v => (projectUpdateDTO.name = v)\"\n        />\n      </div>\n      <div class=\"pt-5\">\n        <label class=\"label\" for=\"url\">URL</label>\n        <j-input\n          :value=\"projectUpdateDTO.url\"\n          id=\"url\"\n          placeholder=\"URL\"\n          @input=\"v => (projectUpdateDTO.url = v)\"\n        />\n      </div>\n      <div class=\"pt-5\">\n        <label class=\"label\" for=\"desc\">Description</label>\n        <j-textarea\n          placeholder=\"No description\"\n          class=\"text-15 bg-backgroundLightest\"\n          :value=\"projectUpdateDTO.description\"\n          @input=\"v => (projectUpdateDTO.description = v)\"\n        />\n        <div class=\"tip\">\n          Describe the project in as much detail as you'd like.\n        </div>\n      </div>\n      <div class=\"pt-5\">\n        <label class=\"label\" for=\"name\">Project Category</label>\n        <j-select\n          :value=\"projectUpdateDTO.category\"\n          searchable\n          :options=\"projectCategoryOptions\"\n          @change=\"v => (projectUpdateDTO.category = v)\"\n        />\n      </div>\n      <div class=\"pt-7\">\n        <j-button\n          :isWorking=\"isWorking\"\n          :disabled=\"!isValid\"\n          @click.prevent=\"handleUpdateProject\"\n          variant=\"primary\"\n          >Save changes</j-button\n        >\n      </div>\n    </form>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, computed, reactive, ref } from '@vue/composition-api'\nimport { ProjectCategoryCopy, ProjectCategory } from '@/types/project'\nimport { getters, mutations } from '@/store'\nimport pick from 'lodash.pick'\nimport { useMutation, useQuery } from '@vue/apollo-composable'\nimport {\n  updateProject,\n  getProjectWithUsersAndWorkorders\n} from '@/graphql/queries/project'\nimport { successToast, errorToast } from '../../plugins/toast'\n\nexport default defineComponent({\n  setup() {\n    const project = computed(getters.project)\n    const isWorking = ref<boolean>(false)\n    const queryEnabled = ref<boolean>(false)\n\n    const projectUpdateDTO = reactive(\n      pick(project.value, ['name', 'url', 'description', 'category'])\n    )\n\n    const isRequired = (value: string) =>\n      ['', null, undefined].indexOf(value) === -1\n\n    const isValid = computed(\n      () =>\n        isRequired(projectUpdateDTO.name) &&\n        isRequired(projectUpdateDTO.category)\n    )\n    const projectCategoryOptions = Object.values(ProjectCategory).map(\n      category => ({\n        value: category,\n        label: ProjectCategoryCopy[category]\n      })\n    )\n\n    const { mutate } = useMutation(updateProject)\n    const { refetch } = useQuery(getProjectWithUsersAndWorkorders, {}, () => ({\n      fetchPolicy: 'network-only',\n      enabled: queryEnabled.value\n    }))\n    const handleUpdateProject = async () => {\n      try {\n        isWorking.value = true\n        queryEnabled.value = true\n        // eslint-disable-next-line\n        await mutate({ project: projectUpdateDTO } as any)\n        const res = await refetch()\n        if (res.data) {\n          console.log(res.data)\n          mutations.setProject(res.data.getProjectWithUsersAndWorkorders)\n        }\n        successToast('Changes have been saved successfully.').showToast()\n        isWorking.value = false\n      } catch (error) {\n        isWorking.value = false\n        errorToast('An error has occurred').showToast()\n      }\n    }\n    return {\n      project,\n      isWorking,\n      projectUpdateDTO,\n      handleUpdateProject,\n      isValid,\n      projectCategoryOptions\n    }\n  }\n})\n</script>\n\n<style lang=\"postcss\" scoped>\n.label {\n  @apply pb-2 font-medium text-13 text-textMedium block;\n}\n.tip {\n  @apply pt-1-5 text-textMedium text-13;\n}\n</style>\n"]}]}