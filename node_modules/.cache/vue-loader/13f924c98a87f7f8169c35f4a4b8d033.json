{"remainingRequest":"/home/ash/Documents/cloudrun/second/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ash/Documents/cloudrun/second/frontend/src/components/Project/Workorder/WorkorderDetails/WorkorderDetails.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/home/ash/Documents/cloudrun/second/frontend/src/components/Project/Workorder/WorkorderDetails/WorkorderDetails.vue","mtime":1601935599674},{"path":"/home/ash/Documents/cloudrun/second/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ash/Documents/cloudrun/second/frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/ash/Documents/cloudrun/second/frontend/node_modules/ts-loader/index.js","mtime":499162500000},{"path":"/home/ash/Documents/cloudrun/second/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ash/Documents/cloudrun/second/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLyogZXNsaW50LWRpc2FibGUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueSAqLwppbXBvcnQgewogIGRlZmluZUNvbXBvbmVudCwKICByZWYsCiAgY29tcHV0ZWQsCiAgb25Vbm1vdW50ZWQKfSBmcm9tICdAdnVlL2NvbXBvc2l0aW9uLWFwaScKaW1wb3J0IHsgdXNlQ2xpcGJvYXJkIH0gZnJvbSAnQC9ob29rcy91c2VDbGlwYm9hcmQnCmltcG9ydCB7IFdvcmtvcmRlciB9IGZyb20gJ0AvdHlwZXMvd29ya29yZGVyJwppbXBvcnQgeyB1c2VRdWVyeSwgdXNlTXV0YXRpb24gfSBmcm9tICdAdnVlL2Fwb2xsby1jb21wb3NhYmxlJwppbXBvcnQgewogIGdldFdvcmtvcmRlcldpdGhVc2Vyc0FuZENvbW1lbnRzLAogIGRlbGV0ZVdvcmtvcmRlciwKICBnZXRQcm9qZWN0V29ya29yZGVycywKICB1cGRhdGVXb3Jrb3JkZXJNdXRhdGlvbgp9IGZyb20gJ0AvZ3JhcGhxbC9xdWVyaWVzL3dvcmtvcmRlcicKaW1wb3J0IFdvcmtvcmRlckxvYWRlciBmcm9tICdAL2NvbXBvbmVudHMvUHJvamVjdC9Xb3Jrb3JkZXJMb2FkZXIudnVlJwppbXBvcnQgQ29tbWVudCBmcm9tICcuL0NvbW1lbnQudnVlJwppbXBvcnQgV29ya29yZGVyRGVzY3JpcHRpb24gZnJvbSAnLi9EZXNjcmlwdGlvbi52dWUnCmltcG9ydCBXb3Jrb3JkZXJUaXRsZSBmcm9tICcuL1RpdGxlLnZ1ZScKaW1wb3J0IFdvcmtvcmRlclR5cGUgZnJvbSAnLi9UeXBlLnZ1ZScKaW1wb3J0IFdvcmtvcmRlclN0YXR1cyBmcm9tICcuL1N0YXR1cy52dWUnCmltcG9ydCBXb3Jrb3JkZXJBc3NpZ25lZXNSZXBvcnRlciBmcm9tICcuL0Fzc2lnbmVlc1JlcG9ydGVyLnZ1ZScKaW1wb3J0IFdvcmtvcmRlclByaW9yaXR5IGZyb20gJy4vUHJpb3JpdHkudnVlJwppbXBvcnQgeyBmb3JtYXREYXRlVGltZUNvbnZlcnNhdGlvbmFsIH0gZnJvbSAnQC91dGlscy9kYXRlJwppbXBvcnQgeyBnZXR0ZXJzLCBtdXRhdGlvbnMgfSBmcm9tICdAL3N0b3JlJwppbXBvcnQgZXZlbnRCdXMgZnJvbSAnQC91dGlscy9ldmVudEJ1cycKaW1wb3J0IHsgZGVsZXRlQ29tbWVudCB9IGZyb20gJ0AvZ3JhcGhxbC9xdWVyaWVzL2NvbW1lbnQnCmltcG9ydCB7IHVwZGF0ZUFycmF5SXRlbUJ5SWQgfSBmcm9tICcuLi8uLi8uLi8uLi91dGlscy9kbmQnCgpjb25zdCBzb3J0QnlOZXdlc3QgPSAoaXRlbXM6IGFueVtdID0gW10sIHNvcnRGaWVsZDogc3RyaW5nKSA9PgogIGl0ZW1zLnNvcnQoKGEsIGIpID0+IC1hW3NvcnRGaWVsZF0ubG9jYWxlQ29tcGFyZShiW3NvcnRGaWVsZF0pKQoKZXhwb3J0IGRlZmF1bHQgZGVmaW5lQ29tcG9uZW50KHsKICBjb21wb25lbnRzOiB7CiAgICBXb3Jrb3JkZXJMb2FkZXIsCiAgICBDb21tZW50LAogICAgV29ya29yZGVyRGVzY3JpcHRpb24sCiAgICBXb3Jrb3JkZXJUaXRsZSwKICAgIFdvcmtvcmRlclR5cGUsCiAgICBXb3Jrb3JkZXJTdGF0dXMsCiAgICBXb3Jrb3JkZXJBc3NpZ25lZXNSZXBvcnRlciwKICAgIFdvcmtvcmRlclByaW9yaXR5CiAgfSwKICBwcm9wczogewogICAgd29ya29yZGVySWQ6IHsKICAgICAgdHlwZTogW1N0cmluZywgTnVtYmVyXSwKICAgICAgcmVxdWlyZWQ6IHRydWUKICAgIH0sCiAgICB3aXRoQ2xvc2VCdXR0b246IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogdHJ1ZQogICAgfSwKICAgIHdpdGhGdWxsU2NyZWVuQnV0dG9uOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IHRydWUKICAgIH0KICB9LAogIHNldHVwKHByb3BzLCB7IHJvb3QsIGVtaXQgfSkgewogICAgY29uc3Qgd29ya29yZGVyQ29weSA9IHJlZjxXb3Jrb3JkZXI+KG51bGwpCiAgICBjb25zdCBwcm9qZWN0ID0gY29tcHV0ZWQoZ2V0dGVycy5wcm9qZWN0KQogICAgY29uc3QgY3VycmVudFVzZXIgPSBjb21wdXRlZChnZXR0ZXJzLmN1cnJlbnRVc2VyKQoKICAgIGNvbnN0IHsgb25SZXN1bHQsIGxvYWRpbmcsIHJlZmV0Y2g6IHJlZmV0Y2hXb3Jrb3JkZXIgfSA9IHVzZVF1ZXJ5PHsKICAgICAgZ2V0V29ya29yZGVyV2l0aFVzZXJzQW5kQ29tbWVudHM6IFdvcmtvcmRlcgogICAgfT4oZ2V0V29ya29yZGVyV2l0aFVzZXJzQW5kQ29tbWVudHMsIHsKICAgICAgaWQ6IE51bWJlcihwcm9wcy53b3Jrb3JkZXJJZCkKICAgIH0pCgogICAgb25SZXN1bHQocmVzID0+IHsKICAgICAgaWYgKHJlcyAmJiByZXMuZGF0YSAmJiAhcmVzLmxvYWRpbmcpIHsKICAgICAgICB3b3Jrb3JkZXJDb3B5LnZhbHVlID0gcmVzLmRhdGEuZ2V0V29ya29yZGVyV2l0aFVzZXJzQW5kQ29tbWVudHMKICAgICAgfQogICAgfSkKCiAgICBjb25zdCBjb21tZW50c1NvcnRlZCA9IGNvbXB1dGVkKCgpID0+IHsKICAgICAgaWYgKCF3b3Jrb3JkZXJDb3B5LnZhbHVlKSB7CiAgICAgICAgcmV0dXJuIFtdCiAgICAgIH0KICAgICAgcmV0dXJuIHNvcnRCeU5ld2VzdCh3b3Jrb3JkZXJDb3B5LnZhbHVlLmNvbW1lbnRzLCAnY3JlYXRlZEF0JykKICAgIH0pCgogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnVzZWQtdmFycwogICAgY29uc3QgW18sIHNldENsaXBib2FyZF0gPSB1c2VDbGlwYm9hcmQoKQoKICAgIGNvbnN0IGNvcHlXb3Jrb3JkZXJMaW5rID0gYXN5bmMgKCkgPT4gewogICAgICBjb25zdCBwYXRoID0KICAgICAgICB3aW5kb3cubG9jYXRpb24ub3JpZ2luICsKICAgICAgICByb290LiRyb3V0ZXIucmVzb2x2ZSh7CiAgICAgICAgICBuYW1lOiAnd29ya29yZGVyJywKICAgICAgICAgIHBhcmFtczogeyB3b3Jrb3JkZXJJZDogYCR7cHJvcHMud29ya29yZGVySWR9YCB9CiAgICAgICAgfSkuaHJlZgoKICAgICAgYXdhaXQgc2V0Q2xpcGJvYXJkKHBhdGgpCiAgICB9CgogICAgY29uc3QgZ29GdWxsU2NyZWVuID0gKCkgPT4gewogICAgICByb290LiRyb3V0ZXIucHVzaCh7CiAgICAgICAgbmFtZTogJ3dvcmtvcmRlcicsCiAgICAgICAgcGFyYW1zOiB7IHdvcmtvcmRlcklkOiBgJHtwcm9wcy53b3Jrb3JkZXJJZH1gIH0KICAgICAgfSkKICAgICAgZW1pdCgnY2xvc2UnKQogICAgfQoKICAgIGNvbnN0IHsgbXV0YXRlOiBtdXRhdGVXb3Jrb3JkZXIgfSA9IHVzZU11dGF0aW9uPHsKICAgICAgdXBkYXRlV29ya29yZGVyOiBXb3Jrb3JkZXIKICAgIH0+KHVwZGF0ZVdvcmtvcmRlck11dGF0aW9uKQoKICAgIGNvbnN0IGhhbmRsZVVwZGF0ZVdvcmtvcmRlciA9IGFzeW5jIChmaWVsZHM6IFBhcnRpYWw8V29ya29yZGVyPikgPT4gewogICAgICB3b3Jrb3JkZXJDb3B5LnZhbHVlID0geyAuLi53b3Jrb3JkZXJDb3B5LnZhbHVlLCAuLi5maWVsZHMgfSBhcyBXb3Jrb3JkZXIKCiAgICAgIG11dGF0aW9ucy5zZXRQcm9qZWN0KHsKICAgICAgICAuLi5wcm9qZWN0LnZhbHVlLAogICAgICAgIHdvcmtvcmRlcnM6IHVwZGF0ZUFycmF5SXRlbUJ5SWQoCiAgICAgICAgICBwcm9qZWN0LnZhbHVlLndvcmtvcmRlcnMsCiAgICAgICAgICBwcm9wcy53b3Jrb3JkZXJJZCBhcyBzdHJpbmcsCiAgICAgICAgICBmaWVsZHMKICAgICAgICApCiAgICAgIH0pCiAgICAgIGF3YWl0IG11dGF0ZVdvcmtvcmRlcih7CiAgICAgICAgd29ya29yZGVySWQ6IE51bWJlcihwcm9wcy53b3Jrb3JkZXJJZCksCiAgICAgICAgd29ya29yZGVyOiB7IC4uLmZpZWxkcyB9CiAgICAgIH0gYXMgYW55KQogICAgICBhd2FpdCByZWZldGNoV29ya29yZGVyKCkKICAgIH0KCiAgICBjb25zdCB7IG11dGF0ZSB9ID0gdXNlTXV0YXRpb248eyBkZWxldGVXb3Jrb3JkZXI6IGJvb2xlYW4gfT4oCiAgICAgIGRlbGV0ZVdvcmtvcmRlcgogICAgKQogICAgY29uc3QgeyByZWZldGNoOiBmZXRjaFByb2plY3RXb3Jrb3JkZXJzIH0gPSB1c2VRdWVyeTx7CiAgICAgIGdldFByb2plY3RXb3Jrb3JkZXJzOiBXb3Jrb3JkZXJbXQogICAgfT4oZ2V0UHJvamVjdFdvcmtvcmRlcnMpCgogICAgLyogLS0tLS0tLS0gRGVsZXRlIFdvcmtvcmRlciAtLS0tLS0tLSAqLwoKICAgIGNvbnN0IGlzRGVsZXRlQ29uZmlybU9wZW4gPSByZWY8Ym9vbGVhbj4oZmFsc2UpCiAgICBjb25zdCB0cmlnZ2VyV29ya29yZGVyRGVsZXRlID0gKCkgPT4gewogICAgICBldmVudEJ1cy4kZW1pdCgndG9nZ2xlLXdvcmtvcmRlci1kZWxldGUnLCB0cnVlLCBwcm9wcy53b3Jrb3JkZXJJZCkKICAgIH0KCiAgICBjb25zdCBkZWxldGVXb3Jrb3JkZXJIYW5kbGVyID0gYXN5bmMgKCkgPT4gewogICAgICBhd2FpdCBtdXRhdGUoeyB3b3Jrb3JkZXJJZDogTnVtYmVyKHByb3BzLndvcmtvcmRlcklkKSB9IGFzIGFueSkKICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2hQcm9qZWN0V29ya29yZGVycygpCiAgICAgIGlmIChyZXMuZGF0YSkgewogICAgICAgIG11dGF0aW9ucy5zZXRQcm9qZWN0KHsKICAgICAgICAgIC4uLnByb2plY3QudmFsdWUsCiAgICAgICAgICB3b3Jrb3JkZXJzOiByZXMuZGF0YS5nZXRQcm9qZWN0V29ya29yZGVycwogICAgICAgIH0pCiAgICAgIH0KICAgICAgZXZlbnRCdXMuJGVtaXQoJ3RvZ2dsZS13b3Jrb3JkZXItZGVsZXRlJywgZmFsc2UpCiAgICAgIGV2ZW50QnVzLiRlbWl0KCd0b2dnbGUtd29ya29yZGVyLWRldGFpbHMnLCBmYWxzZSkKICAgICAgZXZlbnRCdXMuJGVtaXQoJ3RvZ2dsZS13b3Jrb3JkZXItc2VhcmNoJywgZmFsc2UpCiAgICAgIGlmIChyb290LiRyb3V0ZS5uYW1lICE9ICdib2FyZCcpIHsKICAgICAgICByb290LiRyb3V0ZXIucmVwbGFjZSh7IG5hbWU6ICdib2FyZCcgfSkKICAgICAgfQogICAgfQoKICAgIC8qIC0tLS0tLS0tIERlbGV0ZSBDb21tZW50IC0tLS0tLS0tICovCgogICAgY29uc3QgeyBtdXRhdGU6IGRlbGV0ZU11dGF0aW9uIH0gPSB1c2VNdXRhdGlvbihkZWxldGVDb21tZW50KQoKICAgIGNvbnN0IHRyaWdnZUNvbW1lbnREZWxldGUgPSAoaWQ6IHN0cmluZyB8IG51bWJlcikgPT4gewogICAgICBldmVudEJ1cy4kZW1pdCgndG9nZ2xlLWNvbW1lbnQtZGVsZXRlJywgdHJ1ZSwgaWQpCiAgICB9CgogICAgY29uc3QgZGVsZXRlQ29tbWVudEhhbmRsZXIgPSBhc3luYyAoaWQ6IHN0cmluZyB8IG51bWJlcikgPT4gewogICAgICBhd2FpdCBkZWxldGVNdXRhdGlvbih7IGNvbW1lbnRJZDogYCR7aWR9YCB9IGFzIGFueSkKICAgICAgYXdhaXQgcmVmZXRjaFdvcmtvcmRlcigpCiAgICAgIGV2ZW50QnVzLiRlbWl0KCd0b2dnbGUtY29tbWVudC1kZWxldGUnLCBmYWxzZSkKICAgIH0KCiAgICBldmVudEJ1cy4kb24oJ2NvbmZpcm0td29ya29yZGVyLWRlbGV0ZScsIGRlbGV0ZVdvcmtvcmRlckhhbmRsZXIpCgogICAgZXZlbnRCdXMuJG9uKCdjb25maXJtLWNvbW1lbnQtZGVsZXRlJywgZGVsZXRlQ29tbWVudEhhbmRsZXIpCgogICAgb25Vbm1vdW50ZWQoKCkgPT4gewogICAgICBldmVudEJ1cy4kb2ZmKCdjb25maXJtLXdvcmtvcmRlci1kZWxldGUnLCBkZWxldGVXb3Jrb3JkZXJIYW5kbGVyKQogICAgICBldmVudEJ1cy4kb2ZmKCdjb25maXJtLWNvbW1lbnQtZGVsZXRlJywgZGVsZXRlQ29tbWVudEhhbmRsZXIpCiAgICB9KQoKICAgIHJldHVybiB7CiAgICAgIGN1cnJlbnRVc2VyLAogICAgICBwcm9qZWN0LAogICAgICBsb2FkaW5nLAogICAgICByZWZldGNoV29ya29yZGVyLAogICAgICBXb3Jrb3JkZXJTdGF0dXMsCiAgICAgIHdvcmtvcmRlckNvcHksCiAgICAgIGhhbmRsZVVwZGF0ZVdvcmtvcmRlciwKICAgICAgY29weVdvcmtvcmRlckxpbmssCiAgICAgIGdvRnVsbFNjcmVlbiwKICAgICAgdHJpZ2dlcldvcmtvcmRlckRlbGV0ZSwKICAgICAgdHJpZ2dlQ29tbWVudERlbGV0ZSwKICAgICAgY29tbWVudHNTb3J0ZWQsCiAgICAgIGlzRGVsZXRlQ29uZmlybU9wZW4sCiAgICAgIGZvcm1hdERhdGVUaW1lQ29udmVyc2F0aW9uYWwKICAgIH0KICB9Cn0pCg=="},{"version":3,"sources":["WorkorderDetails.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"WorkorderDetails.vue","sourceRoot":"src/components/Project/Workorder/WorkorderDetails","sourcesContent":["<template>\n  <Loader v-if=\"!workorderCopy\" />\n  <div class=\"w-full h-full\" v-else>\n    <div class=\"flex items-center px-3 pt-4 text-textDarkest\">\n      <!-- Type -->\n      <WorkorderType\n        :updateWorkorder=\"handleUpdateWorkorder\"\n        :workorderId=\"workorderCopy.id\"\n        :value=\"workorderCopy.type\"\n      />\n      <div class=\"flex-auto\"></div>\n      <j-button icon=\"feedback\" variant=\"empty\">Give Feedback</j-button>\n      <j-button @click=\"copyWorkorderLink\" icon=\"link\" variant=\"empty\"\n        >Copy Link</j-button\n      >\n      <j-button @click=\"triggerWorkorderDelete\" icon=\"trash\" variant=\"empty\" />\n      <j-button\n        v-if=\"withFullScreenButton\"\n        @click=\"goFullScreen\"\n        icon=\"expand\"\n        :iconSize=\"24\"\n        variant=\"empty\"\n      />\n      <j-button\n        v-if=\"withCloseButton\"\n        @click=\"$emit('close')\"\n        icon=\"times\"\n        :iconSize=\"24\"\n        variant=\"empty\"\n      />\n    </div>\n    <div class=\"flex w-full flex-wrap pb-16 px-7\">\n      <!-- LEFT SECTION -->\n      <div class=\"sm:w-full md:w-7/12 lg:w-4/6 pr-10\">\n        <!-- Title -->\n        <WorkorderTitle\n          :updateWorkorder=\"handleUpdateWorkorder\"\n          :value=\"workorderCopy.title\"\n        />\n        <!-- Description -->\n        <WorkorderDescription\n          :updateWorkorder=\"handleUpdateWorkorder\"\n          :initialValue=\"workorderCopy.description\"\n        />\n        <!-- Comments -->\n        <div class=\"pt-10\">\n          <div class=\"font-medium text-15\">Comments</div>\n          <Comment\n            :refetchWorkorder=\"refetchWorkorder\"\n            isCreate\n            :comment=\"{\n              user: currentUser,\n              body: 'Add a comment...',\n              workorderId\n            }\"\n          />\n          <Comment\n            @delete=\"triggeCommentDelete\"\n            :refetchWorkorder=\"refetchWorkorder\"\n            :comment=\"comment\"\n            v-for=\"comment in commentsSorted\"\n            :key=\"comment.id\"\n          />\n        </div>\n      </div>\n      <!-- RIGHT SECTION -->\n      <div class=\"sm:w-full md:w-5/12 lg:w-2/6 pt-1\">\n        <!-- STATUS -->\n        <WorkorderStatus\n          :updateWorkorder=\"handleUpdateWorkorder\"\n          :value=\"workorderCopy.status\"\n        />\n        <!-- AssigneesReporter -->\n        <WorkorderAssigneesReporter\n          :reporterId=\"workorderCopy.reporterId\"\n          :userIds=\"workorderCopy.userIds\"\n          :updateWorkorder=\"handleUpdateWorkorder\"\n        />\n        <!-- PRIORITY -->\n        <WorkorderPriority\n          :value=\"workorderCopy.priority\"\n          :updateWorkorder=\"handleUpdateWorkorder\"\n        />\n        <!-- DATES -->\n        <div\n          class=\"mt-3 pt-3 leading-loose border-t border-borderLightest text-textMedium text-13\"\n        >\n          <div>\n            Created -\n            {{ formatDateTimeConversational(workorderCopy.createdAt) }}\n          </div>\n          <div>\n            Updated -\n            {{ formatDateTimeConversational(workorderCopy.updatedAt) }}\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport {\n  defineComponent,\n  ref,\n  computed,\n  onUnmounted\n} from '@vue/composition-api'\nimport { useClipboard } from '@/hooks/useClipboard'\nimport { Workorder } from '@/types/workorder'\nimport { useQuery, useMutation } from '@vue/apollo-composable'\nimport {\n  getWorkorderWithUsersAndComments,\n  deleteWorkorder,\n  getProjectWorkorders,\n  updateWorkorderMutation\n} from '@/graphql/queries/workorder'\nimport WorkorderLoader from '@/components/Project/WorkorderLoader.vue'\nimport Comment from './Comment.vue'\nimport WorkorderDescription from './Description.vue'\nimport WorkorderTitle from './Title.vue'\nimport WorkorderType from './Type.vue'\nimport WorkorderStatus from './Status.vue'\nimport WorkorderAssigneesReporter from './AssigneesReporter.vue'\nimport WorkorderPriority from './Priority.vue'\nimport { formatDateTimeConversational } from '@/utils/date'\nimport { getters, mutations } from '@/store'\nimport eventBus from '@/utils/eventBus'\nimport { deleteComment } from '@/graphql/queries/comment'\nimport { updateArrayItemById } from '../../../../utils/dnd'\n\nconst sortByNewest = (items: any[] = [], sortField: string) =>\n  items.sort((a, b) => -a[sortField].localeCompare(b[sortField]))\n\nexport default defineComponent({\n  components: {\n    WorkorderLoader,\n    Comment,\n    WorkorderDescription,\n    WorkorderTitle,\n    WorkorderType,\n    WorkorderStatus,\n    WorkorderAssigneesReporter,\n    WorkorderPriority\n  },\n  props: {\n    workorderId: {\n      type: [String, Number],\n      required: true\n    },\n    withCloseButton: {\n      type: Boolean,\n      default: true\n    },\n    withFullScreenButton: {\n      type: Boolean,\n      default: true\n    }\n  },\n  setup(props, { root, emit }) {\n    const workorderCopy = ref<Workorder>(null)\n    const project = computed(getters.project)\n    const currentUser = computed(getters.currentUser)\n\n    const { onResult, loading, refetch: refetchWorkorder } = useQuery<{\n      getWorkorderWithUsersAndComments: Workorder\n    }>(getWorkorderWithUsersAndComments, {\n      id: Number(props.workorderId)\n    })\n\n    onResult(res => {\n      if (res && res.data && !res.loading) {\n        workorderCopy.value = res.data.getWorkorderWithUsersAndComments\n      }\n    })\n\n    const commentsSorted = computed(() => {\n      if (!workorderCopy.value) {\n        return []\n      }\n      return sortByNewest(workorderCopy.value.comments, 'createdAt')\n    })\n\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    const [_, setClipboard] = useClipboard()\n\n    const copyWorkorderLink = async () => {\n      const path =\n        window.location.origin +\n        root.$router.resolve({\n          name: 'workorder',\n          params: { workorderId: `${props.workorderId}` }\n        }).href\n\n      await setClipboard(path)\n    }\n\n    const goFullScreen = () => {\n      root.$router.push({\n        name: 'workorder',\n        params: { workorderId: `${props.workorderId}` }\n      })\n      emit('close')\n    }\n\n    const { mutate: mutateWorkorder } = useMutation<{\n      updateWorkorder: Workorder\n    }>(updateWorkorderMutation)\n\n    const handleUpdateWorkorder = async (fields: Partial<Workorder>) => {\n      workorderCopy.value = { ...workorderCopy.value, ...fields } as Workorder\n\n      mutations.setProject({\n        ...project.value,\n        workorders: updateArrayItemById(\n          project.value.workorders,\n          props.workorderId as string,\n          fields\n        )\n      })\n      await mutateWorkorder({\n        workorderId: Number(props.workorderId),\n        workorder: { ...fields }\n      } as any)\n      await refetchWorkorder()\n    }\n\n    const { mutate } = useMutation<{ deleteWorkorder: boolean }>(\n      deleteWorkorder\n    )\n    const { refetch: fetchProjectWorkorders } = useQuery<{\n      getProjectWorkorders: Workorder[]\n    }>(getProjectWorkorders)\n\n    /* -------- Delete Workorder -------- */\n\n    const isDeleteConfirmOpen = ref<boolean>(false)\n    const triggerWorkorderDelete = () => {\n      eventBus.$emit('toggle-workorder-delete', true, props.workorderId)\n    }\n\n    const deleteWorkorderHandler = async () => {\n      await mutate({ workorderId: Number(props.workorderId) } as any)\n      const res = await fetchProjectWorkorders()\n      if (res.data) {\n        mutations.setProject({\n          ...project.value,\n          workorders: res.data.getProjectWorkorders\n        })\n      }\n      eventBus.$emit('toggle-workorder-delete', false)\n      eventBus.$emit('toggle-workorder-details', false)\n      eventBus.$emit('toggle-workorder-search', false)\n      if (root.$route.name != 'board') {\n        root.$router.replace({ name: 'board' })\n      }\n    }\n\n    /* -------- Delete Comment -------- */\n\n    const { mutate: deleteMutation } = useMutation(deleteComment)\n\n    const triggeCommentDelete = (id: string | number) => {\n      eventBus.$emit('toggle-comment-delete', true, id)\n    }\n\n    const deleteCommentHandler = async (id: string | number) => {\n      await deleteMutation({ commentId: `${id}` } as any)\n      await refetchWorkorder()\n      eventBus.$emit('toggle-comment-delete', false)\n    }\n\n    eventBus.$on('confirm-workorder-delete', deleteWorkorderHandler)\n\n    eventBus.$on('confirm-comment-delete', deleteCommentHandler)\n\n    onUnmounted(() => {\n      eventBus.$off('confirm-workorder-delete', deleteWorkorderHandler)\n      eventBus.$off('confirm-comment-delete', deleteCommentHandler)\n    })\n\n    return {\n      currentUser,\n      project,\n      loading,\n      refetchWorkorder,\n      WorkorderStatus,\n      workorderCopy,\n      handleUpdateWorkorder,\n      copyWorkorderLink,\n      goFullScreen,\n      triggerWorkorderDelete,\n      triggeCommentDelete,\n      commentsSorted,\n      isDeleteConfirmOpen,\n      formatDateTimeConversational\n    }\n  }\n})\n</script>\n\n<style lang=\"postcss\" scoped>\n.formField {\n  @apply mt-5;\n}\n.sep {\n  @apply mt-5 border border-backgroundLightest;\n}\n.formFieldLabel {\n  @apply block pb-1-25 text-textMedium text-13 font-medium;\n}\n.formFieldTip {\n  @apply pt-1-5 text-textMedium text-13;\n}\n</style>\n\n<style lang=\"scss\" scoped>\n.error {\n  position: absolute;\n  right: 0;\n  top: 0;\n  padding: 2px 10px;\n  background: #f53b57;\n  color: white;\n  font-size: 12px;\n  border-bottom-left-radius: 3px;\n  border-top-right-radius: 3px;\n}\n</style>\n"]}]}