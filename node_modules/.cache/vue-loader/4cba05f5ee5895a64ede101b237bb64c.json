{"remainingRequest":"/home/ash/Documents/cloudrun/second/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ash/Documents/cloudrun/second/frontend/src/components/Project/Lists/List.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/home/ash/Documents/cloudrun/second/frontend/src/components/Project/Lists/List.vue","mtime":1601934621303},{"path":"/home/ash/Documents/cloudrun/second/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ash/Documents/cloudrun/second/frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/ash/Documents/cloudrun/second/frontend/node_modules/ts-loader/index.js","mtime":499162500000},{"path":"/home/ash/Documents/cloudrun/second/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ash/Documents/cloudrun/second/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCmltcG9ydCBkYXlqcyBmcm9tICdkYXlqcycKaW1wb3J0IHsgZGVmaW5lQ29tcG9uZW50LCBjb21wdXRlZCB9IGZyb20gJ0B2dWUvY29tcG9zaXRpb24tYXBpJwppbXBvcnQgeyBDb250YWluZXIsIERyYWdnYWJsZSB9IGZyb20gJ3Z1ZS1zbW9vdGgtZG5kJwoKaW1wb3J0IFdvcmtvcmRlckNvbXBvbmVudCBmcm9tICdAL2NvbXBvbmVudHMvUHJvamVjdC9Xb3Jrb3JkZXIvV29ya29yZGVyLnZ1ZScKaW1wb3J0IHsgRmlsdGVycyB9IGZyb20gJ0AvdHlwZXMvZmlsdGVycycKaW1wb3J0IHsKICBXb3Jrb3JkZXIsCiAgV29ya29yZGVyU3RhdHVzQ29weSwKICBXb3Jrb3JkZXJTdGF0dXMKfSBmcm9tICdAL3R5cGVzL3dvcmtvcmRlcicKaW1wb3J0IHsgZ2V0dGVycyB9IGZyb20gJ0Avc3RvcmUnCmltcG9ydCB7IERyb3BSZXN1bHQsIGdldFNvcnRlZExpc3RXb3Jrb3JkZXJzIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvZG5kJwoKY29uc3QgZmlsdGVyV29ya29yZGVycyA9ICgKICBwcm9qZWN0V29ya29yZGVyczogQXJyYXk8V29ya29yZGVyPiwKICBmaWx0ZXJzOiBGaWx0ZXJzLAogIGN1cnJlbnRVc2VySWQ6IHN0cmluZwopID0+IHsKICBjb25zdCB7IHNlYXJjaFRlcm0sIHVzZXJJZHMsIG15T25seSwgcmVjZW50IH0gPSBmaWx0ZXJzCgogIGxldCBXb3Jrb3JkZXJzID0gWy4uLnByb2plY3RXb3Jrb3JkZXJzXQoKICBpZiAoc2VhcmNoVGVybSkgewogICAgV29ya29yZGVycyA9IFdvcmtvcmRlcnMuZmlsdGVyKFdvcmtvcmRlciA9PgogICAgICBXb3Jrb3JkZXIudGl0bGUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzZWFyY2hUZXJtLnRvTG93ZXJDYXNlKCkpCiAgICApCiAgfQogIGlmICh1c2VySWRzLmxlbmd0aCA+IDApIHsKICAgIFdvcmtvcmRlcnMgPSBXb3Jrb3JkZXJzLmZpbHRlcigKICAgICAgV29ya29yZGVyID0+CiAgICAgICAgW1dvcmtvcmRlci51c2VySWRzLCB1c2VySWRzXS5yZWR1Y2UoKGEsIGIpID0+CiAgICAgICAgICBhLmZpbHRlcihjID0+IGIuaW5jbHVkZXMoYykpCiAgICAgICAgKS5sZW5ndGggPiAwCiAgICApCiAgfQogIGlmIChteU9ubHkgJiYgY3VycmVudFVzZXJJZCkgewogICAgV29ya29yZGVycyA9IFdvcmtvcmRlcnMuZmlsdGVyKFdvcmtvcmRlciA9PgogICAgICBXb3Jrb3JkZXIudXNlcklkcy5pbmNsdWRlcyhjdXJyZW50VXNlcklkKQogICAgKQogIH0KICBpZiAocmVjZW50KSB7CiAgICBXb3Jrb3JkZXJzID0gV29ya29yZGVycy5maWx0ZXIoV29ya29yZGVyID0+CiAgICAgIGRheWpzKFdvcmtvcmRlci51cGRhdGVkQXQpLmlzQWZ0ZXIoZGF5anMoKS5zdWJ0cmFjdCgzLCAnZGF5JykpCiAgICApCiAgfQogIHJldHVybiBXb3Jrb3JkZXJzCn0KCmV4cG9ydCBkZWZhdWx0IGRlZmluZUNvbXBvbmVudCh7CiAgcHJvcHM6IHsKICAgIHN0YXR1czogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICB9CiAgfSwKICBjb21wb25lbnRzOiB7CiAgICBXb3Jrb3JkZXI6IFdvcmtvcmRlckNvbXBvbmVudCwKICAgIENvbnRhaW5lciwKICAgIERyYWdnYWJsZQogIH0sCiAgc2V0dXAocHJvcHMsIHsgZW1pdCB9KSB7CiAgICBjb25zdCBwcm9qZWN0ID0gY29tcHV0ZWQoZ2V0dGVycy5wcm9qZWN0KQogICAgY29uc3QgZmlsdGVycyA9IGNvbXB1dGVkKGdldHRlcnMuZmlsdGVycykKICAgIGNvbnN0IGN1cnJlbnRVc2VySWQgPSBjb21wdXRlZCgoKSA9PiBnZXR0ZXJzLmN1cnJlbnRVc2VyKCkuaWQpCgogICAgY29uc3QgZmlsdGVyZWRXb3Jrb3JkZXJzID0gY29tcHV0ZWQoKCkgPT4KICAgICAgZmlsdGVyV29ya29yZGVycygKICAgICAgICBwcm9qZWN0LnZhbHVlLndvcmtvcmRlcnMsCiAgICAgICAgZmlsdGVycy52YWx1ZSwKICAgICAgICBjdXJyZW50VXNlcklkLnZhbHVlCiAgICAgICkKICAgICkKICAgIGNvbnN0IGZpbHRlcmVkTGlzdFdvcmtvcmRlcnMgPSBjb21wdXRlZCgoKSA9PgogICAgICBnZXRTb3J0ZWRMaXN0V29ya29yZGVycyhmaWx0ZXJlZFdvcmtvcmRlcnMudmFsdWUsIHByb3BzLnN0YXR1cykKICAgICkKCiAgICBjb25zdCBhbGxMaXN0V29ya29yZGVycyA9IGNvbXB1dGVkKCgpID0+CiAgICAgIGdldFNvcnRlZExpc3RXb3Jrb3JkZXJzKHByb2plY3QudmFsdWUud29ya29yZGVycywgcHJvcHMuc3RhdHVzKQogICAgKQoKICAgIGNvbnN0IGZvcm1hdGVkV29ya29yZGVyc0NvdW50ID0gY29tcHV0ZWQoKCkgPT4gewogICAgICBpZiAoCiAgICAgICAgYWxsTGlzdFdvcmtvcmRlcnMudmFsdWUubGVuZ3RoICE9PSBmaWx0ZXJlZExpc3RXb3Jrb3JkZXJzLnZhbHVlLmxlbmd0aAogICAgICApIHsKICAgICAgICByZXR1cm4gYCR7ZmlsdGVyZWRMaXN0V29ya29yZGVycy52YWx1ZS5sZW5ndGh9IG9mICR7YWxsTGlzdFdvcmtvcmRlcnMudmFsdWUubGVuZ3RofWAKICAgICAgfQogICAgICByZXR1cm4gYWxsTGlzdFdvcmtvcmRlcnMudmFsdWUubGVuZ3RoCiAgICB9KQoKICAgIGNvbnN0IGRyb3BQbGFjZWhvbGRlck9wdGlvbnMgPSB7CiAgICAgIGNsYXNzTmFtZTogJ2Ryb3AtcHJldmlldycsCiAgICAgIGFuaW1hdGlvbkR1cmF0aW9uOiAnMTUwJywKICAgICAgc2hvd09uVG9wOiB0cnVlCiAgICB9CgogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lCiAgICBjb25zdCBvbkRyb3AgPSAoZHJvcFJlc3VsdDogYW55KSA9PiB7CiAgICAgIGNvbnN0IGFyciA9IE9iamVjdC52YWx1ZXMoV29ya29yZGVyU3RhdHVzKQogICAgICBjb25zdCB0byA9IGFyci5pbmRleE9mKHByb3BzLnN0YXR1cyBhcyBXb3Jrb3JkZXJTdGF0dXMpCiAgICAgIGVtaXQoJ2Ryb3AnLCB7IC4uLmRyb3BSZXN1bHQsIHRvIH0gYXMgRHJvcFJlc3VsdCkKICAgIH0KICAgIGNvbnN0IGdldENhcmRQYXlsb2FkID0gKGluZGV4OiBudW1iZXIpID0+IHsKICAgICAgY29uc3QgV29ya29yZGVyc0J5U3RhdHVzID0gZ2V0U29ydGVkTGlzdFdvcmtvcmRlcnMoCiAgICAgICAgZmlsdGVyZWRMaXN0V29ya29yZGVycy52YWx1ZSwKICAgICAgICBwcm9wcy5zdGF0dXMKICAgICAgKQogICAgICByZXR1cm4gV29ya29yZGVyc0J5U3RhdHVzW2luZGV4XQogICAgfQogICAgcmV0dXJuIHsKICAgICAgb25Ecm9wLAogICAgICBnZXRDYXJkUGF5bG9hZCwKICAgICAgZHJvcFBsYWNlaG9sZGVyT3B0aW9ucywKICAgICAgZmlsdGVyZWRMaXN0V29ya29yZGVycywKICAgICAgZm9ybWF0ZWRXb3Jrb3JkZXJzQ291bnQsCiAgICAgIFdvcmtvcmRlclN0YXR1c0NvcHkKICAgIH0KICB9Cn0pCg=="},{"version":3,"sources":["List.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4BA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"List.vue","sourceRoot":"src/components/Project/Lists","sourcesContent":["<template>\n  <div class=\"list\">\n    <div class=\"px-3 pb-4 pt-3 uppercase text-textMedium text-13 truncate\">\n      {{ WorkorderStatusCopy[status] }}\n      <span class=\"lowercase text-13\">{{ formatedWorkordersCount }}</span>\n    </div>\n    <div class=\"h-full px-2\">\n      <Container\n        class=\"h-full\"\n        group-name=\"board\"\n        @drop=\"onDrop\"\n        drag-class=\"card-ghost\"\n        drop-class=\"card-ghost-drop\"\n        :get-child-payload=\"getCardPayload\"\n        :drop-placeholder=\"dropPlaceholderOptions\"\n      >\n        <Draggable\n          v-for=\"(Workorder, index) in filteredListWorkorders\"\n          :key=\"Workorder.id\"\n        >\n          <Workorder :Workorder=\"Workorder\" :index=\"index\" />\n        </Draggable>\n      </Container>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport dayjs from 'dayjs'\nimport { defineComponent, computed } from '@vue/composition-api'\nimport { Container, Draggable } from 'vue-smooth-dnd'\n\nimport WorkorderComponent from '@/components/Project/Workorder/Workorder.vue'\nimport { Filters } from '@/types/filters'\nimport {\n  Workorder,\n  WorkorderStatusCopy,\n  WorkorderStatus\n} from '@/types/workorder'\nimport { getters } from '@/store'\nimport { DropResult, getSortedListWorkorders } from '../../../utils/dnd'\n\nconst filterWorkorders = (\n  projectWorkorders: Array<Workorder>,\n  filters: Filters,\n  currentUserId: string\n) => {\n  const { searchTerm, userIds, myOnly, recent } = filters\n\n  let Workorders = [...projectWorkorders]\n\n  if (searchTerm) {\n    Workorders = Workorders.filter(Workorder =>\n      Workorder.title.toLowerCase().includes(searchTerm.toLowerCase())\n    )\n  }\n  if (userIds.length > 0) {\n    Workorders = Workorders.filter(\n      Workorder =>\n        [Workorder.userIds, userIds].reduce((a, b) =>\n          a.filter(c => b.includes(c))\n        ).length > 0\n    )\n  }\n  if (myOnly && currentUserId) {\n    Workorders = Workorders.filter(Workorder =>\n      Workorder.userIds.includes(currentUserId)\n    )\n  }\n  if (recent) {\n    Workorders = Workorders.filter(Workorder =>\n      dayjs(Workorder.updatedAt).isAfter(dayjs().subtract(3, 'day'))\n    )\n  }\n  return Workorders\n}\n\nexport default defineComponent({\n  props: {\n    status: {\n      type: String,\n      required: true\n    }\n  },\n  components: {\n    Workorder: WorkorderComponent,\n    Container,\n    Draggable\n  },\n  setup(props, { emit }) {\n    const project = computed(getters.project)\n    const filters = computed(getters.filters)\n    const currentUserId = computed(() => getters.currentUser().id)\n\n    const filteredWorkorders = computed(() =>\n      filterWorkorders(\n        project.value.workorders,\n        filters.value,\n        currentUserId.value\n      )\n    )\n    const filteredListWorkorders = computed(() =>\n      getSortedListWorkorders(filteredWorkorders.value, props.status)\n    )\n\n    const allListWorkorders = computed(() =>\n      getSortedListWorkorders(project.value.workorders, props.status)\n    )\n\n    const formatedWorkordersCount = computed(() => {\n      if (\n        allListWorkorders.value.length !== filteredListWorkorders.value.length\n      ) {\n        return `${filteredListWorkorders.value.length} of ${allListWorkorders.value.length}`\n      }\n      return allListWorkorders.value.length\n    })\n\n    const dropPlaceholderOptions = {\n      className: 'drop-preview',\n      animationDuration: '150',\n      showOnTop: true\n    }\n\n    // eslint-disable-next-line\n    const onDrop = (dropResult: any) => {\n      const arr = Object.values(WorkorderStatus)\n      const to = arr.indexOf(props.status as WorkorderStatus)\n      emit('drop', { ...dropResult, to } as DropResult)\n    }\n    const getCardPayload = (index: number) => {\n      const WorkordersByStatus = getSortedListWorkorders(\n        filteredListWorkorders.value,\n        props.status\n      )\n      return WorkordersByStatus[index]\n    }\n    return {\n      onDrop,\n      getCardPayload,\n      dropPlaceholderOptions,\n      filteredListWorkorders,\n      formatedWorkordersCount,\n      WorkorderStatusCopy\n    }\n  }\n})\n</script>\n\n<style lang=\"postcss\" scoped>\n.list {\n  @apply mr-2 flex flex-col  rounded-sm bg-backgroundLightest flex-shrink-0;\n  width: calc(100% / 4 - 8px);\n  min-height: 400px;\n  min-width: 200px;\n}\n</style>\n\n<style lang=\"scss\">\n.drop-preview {\n  background-color: rgba(150, 150, 200, 0.1);\n  border: 1px dashed #abc;\n  margin: 5px;\n}\n.card-ghost {\n  transition: transform 0.18s ease;\n  transform: rotateZ(5deg);\n}\n.card-ghost-drop {\n  transition: transform 0.18s ease-in-out;\n  transform: rotateZ(0deg);\n}\n</style>\n"]}]}