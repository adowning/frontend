{"remainingRequest":"/home/ash/Documents/cloudrun/second/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ash/Documents/cloudrun/second/frontend/src/views/Project/Settings.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/home/ash/Documents/cloudrun/second/frontend/src/views/Project/Settings.vue","mtime":1601936750531},{"path":"/home/ash/Documents/cloudrun/second/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ash/Documents/cloudrun/second/frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/ash/Documents/cloudrun/second/frontend/node_modules/ts-loader/index.js","mtime":499162500000},{"path":"/home/ash/Documents/cloudrun/second/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ash/Documents/cloudrun/second/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKaW1wb3J0IHsgZGVmaW5lQ29tcG9uZW50LCBjb21wdXRlZCwgcmVhY3RpdmUsIHJlZiB9IGZyb20gJ0B2dWUvY29tcG9zaXRpb24tYXBpJwppbXBvcnQgeyBQcm9qZWN0Q2F0ZWdvcnlDb3B5LCBQcm9qZWN0Q2F0ZWdvcnkgfSBmcm9tICdAL3R5cGVzL3Byb2plY3QnCmltcG9ydCB7IGdldHRlcnMsIG11dGF0aW9ucyB9IGZyb20gJ0Avc3RvcmUnCmltcG9ydCBwaWNrIGZyb20gJ2xvZGFzaC5waWNrJwppbXBvcnQgeyB1c2VNdXRhdGlvbiwgdXNlUXVlcnkgfSBmcm9tICdAdnVlL2Fwb2xsby1jb21wb3NhYmxlJwppbXBvcnQgewogIHVwZGF0ZVByb2plY3QsCiAgZ2V0UHJvamVjdFdpdGhVc2Vyc0FuZFdvcmtvcmRlcnMKfSBmcm9tICdAL2dyYXBocWwvcXVlcmllcy9wcm9qZWN0JwppbXBvcnQgeyBzdWNjZXNzVG9hc3QsIGVycm9yVG9hc3QgfSBmcm9tICcuLi8uLi9wbHVnaW5zL3RvYXN0JwoKZXhwb3J0IGRlZmF1bHQgZGVmaW5lQ29tcG9uZW50KHsKICBzZXR1cCgpIHsKICAgIGNvbnN0IHByb2plY3QgPSBjb21wdXRlZChnZXR0ZXJzLnByb2plY3QpCiAgICBjb25zdCBpc1dvcmtpbmcgPSByZWY8Ym9vbGVhbj4oZmFsc2UpCiAgICBjb25zdCBxdWVyeUVuYWJsZWQgPSByZWY8Ym9vbGVhbj4oZmFsc2UpCgogICAgY29uc3QgcHJvamVjdFVwZGF0ZURUTyA9IHJlYWN0aXZlKAogICAgICBwaWNrKHByb2plY3QudmFsdWUsIFsnbmFtZScsICd1cmwnLCAnZGVzY3JpcHRpb24nLCAnY2F0ZWdvcnknXSkKICAgICkKCiAgICBjb25zdCBpc1JlcXVpcmVkID0gKHZhbHVlOiBzdHJpbmcpID0+CiAgICAgIFsnJywgbnVsbCwgdW5kZWZpbmVkXS5pbmRleE9mKHZhbHVlKSA9PT0gLTEKCiAgICBjb25zdCBpc1ZhbGlkID0gY29tcHV0ZWQoCiAgICAgICgpID0+CiAgICAgICAgaXNSZXF1aXJlZChwcm9qZWN0VXBkYXRlRFRPLm5hbWUpICYmCiAgICAgICAgaXNSZXF1aXJlZChwcm9qZWN0VXBkYXRlRFRPLmNhdGVnb3J5KQogICAgKQogICAgY29uc3QgcHJvamVjdENhdGVnb3J5T3B0aW9ucyA9IE9iamVjdC52YWx1ZXMoUHJvamVjdENhdGVnb3J5KS5tYXAoCiAgICAgIGNhdGVnb3J5ID0+ICh7CiAgICAgICAgdmFsdWU6IGNhdGVnb3J5LAogICAgICAgIGxhYmVsOiBQcm9qZWN0Q2F0ZWdvcnlDb3B5W2NhdGVnb3J5XQogICAgICB9KQogICAgKQoKICAgIGNvbnN0IHsgbXV0YXRlIH0gPSB1c2VNdXRhdGlvbih1cGRhdGVQcm9qZWN0KQogICAgY29uc3QgeyByZWZldGNoIH0gPSB1c2VRdWVyeShnZXRQcm9qZWN0V2l0aFVzZXJzQW5kV29ya29yZGVycywge30sICgpID0+ICh7CiAgICAgIGZldGNoUG9saWN5OiAnbmV0d29yay1vbmx5JywKICAgICAgZW5hYmxlZDogcXVlcnlFbmFibGVkLnZhbHVlCiAgICB9KSkKICAgIGNvbnN0IGhhbmRsZVVwZGF0ZVByb2plY3QgPSBhc3luYyAoKSA9PiB7CiAgICAgIHRyeSB7CiAgICAgICAgaXNXb3JraW5nLnZhbHVlID0gdHJ1ZQogICAgICAgIHF1ZXJ5RW5hYmxlZC52YWx1ZSA9IHRydWUKICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUKICAgICAgICBhd2FpdCBtdXRhdGUoeyBwcm9qZWN0OiBwcm9qZWN0VXBkYXRlRFRPIH0gYXMgYW55KQogICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHJlZmV0Y2goKQogICAgICAgIGlmIChyZXMuZGF0YSkgewogICAgICAgICAgY29uc29sZS5sb2cocmVzLmRhdGEpCiAgICAgICAgICBtdXRhdGlvbnMuc2V0UHJvamVjdChyZXMuZGF0YS5nZXRQcm9qZWN0V2l0aFVzZXJzQW5kV29ya29yZGVycykKICAgICAgICB9CiAgICAgICAgc3VjY2Vzc1RvYXN0KCdDaGFuZ2VzIGhhdmUgYmVlbiBzYXZlZCBzdWNjZXNzZnVsbHkuJykuc2hvd1RvYXN0KCkKICAgICAgICBpc1dvcmtpbmcudmFsdWUgPSBmYWxzZQogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGlzV29ya2luZy52YWx1ZSA9IGZhbHNlCiAgICAgICAgZXJyb3JUb2FzdCgnQW4gZXJyb3IgaGFzIG9jY3VycmVkJykuc2hvd1RvYXN0KCkKICAgICAgfQogICAgfQogICAgcmV0dXJuIHsKICAgICAgcHJvamVjdCwKICAgICAgaXNXb3JraW5nLAogICAgICBwcm9qZWN0VXBkYXRlRFRPLAogICAgICBoYW5kbGVVcGRhdGVQcm9qZWN0LAogICAgICBpc1ZhbGlkLAogICAgICBwcm9qZWN0Q2F0ZWdvcnlPcHRpb25zCiAgICB9CiAgfQp9KQo="},{"version":3,"sources":["Settings.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Settings.vue","sourceRoot":"src/views/Project","sourcesContent":["<template>\n  <div class=\"pr-6 py-8 pl-10 h-full w-full flex flex-col\">\n    <j-breadcrumbs :items=\"['Projects', project.name, 'Project Details']\" />\n    <header class=\"mt-3 flex justify-between text-textDarkest\">\n      <div class=\"text-2xl font-medium\">Project Details</div>\n    </header>\n    <form @submit.prevent style=\"max-width:640px\" autocomplete=\"off\" novalidate>\n      <div class=\"pt-5\">\n        <label class=\"label\" for=\"name\">Name</label>\n        <j-input\n          :value=\"projectUpdateDTO.name\"\n          id=\"name\"\n          placeholder=\"Project name\"\n          @input=\"v => (projectUpdateDTO.name = v)\"\n        />\n      </div>\n      <div class=\"pt-5\">\n        <label class=\"label\" for=\"url\">URL</label>\n        <j-input\n          :value=\"projectUpdateDTO.url\"\n          id=\"url\"\n          placeholder=\"URL\"\n          @input=\"v => (projectUpdateDTO.url = v)\"\n        />\n      </div>\n      <div class=\"pt-5\">\n        <label class=\"label\" for=\"desc\">Description</label>\n        <j-textarea\n          placeholder=\"No description\"\n          class=\"text-15 bg-backgroundLightest\"\n          :value=\"projectUpdateDTO.description\"\n          @input=\"v => (projectUpdateDTO.description = v)\"\n        />\n        <div class=\"tip\">\n          Describe the project in as much detail as you'd like.\n        </div>\n      </div>\n      <div class=\"pt-5\">\n        <label class=\"label\" for=\"name\">Project Category</label>\n        <j-select\n          :value=\"projectUpdateDTO.category\"\n          searchable\n          :options=\"projectCategoryOptions\"\n          @change=\"v => (projectUpdateDTO.category = v)\"\n        />\n      </div>\n      <div class=\"pt-7\">\n        <j-button\n          :isWorking=\"isWorking\"\n          :disabled=\"!isValid\"\n          @click.prevent=\"handleUpdateProject\"\n          variant=\"primary\"\n          >Save changes</j-button\n        >\n      </div>\n    </form>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, computed, reactive, ref } from '@vue/composition-api'\nimport { ProjectCategoryCopy, ProjectCategory } from '@/types/project'\nimport { getters, mutations } from '@/store'\nimport pick from 'lodash.pick'\nimport { useMutation, useQuery } from '@vue/apollo-composable'\nimport {\n  updateProject,\n  getProjectWithUsersAndWorkorders\n} from '@/graphql/queries/project'\nimport { successToast, errorToast } from '../../plugins/toast'\n\nexport default defineComponent({\n  setup() {\n    const project = computed(getters.project)\n    const isWorking = ref<boolean>(false)\n    const queryEnabled = ref<boolean>(false)\n\n    const projectUpdateDTO = reactive(\n      pick(project.value, ['name', 'url', 'description', 'category'])\n    )\n\n    const isRequired = (value: string) =>\n      ['', null, undefined].indexOf(value) === -1\n\n    const isValid = computed(\n      () =>\n        isRequired(projectUpdateDTO.name) &&\n        isRequired(projectUpdateDTO.category)\n    )\n    const projectCategoryOptions = Object.values(ProjectCategory).map(\n      category => ({\n        value: category,\n        label: ProjectCategoryCopy[category]\n      })\n    )\n\n    const { mutate } = useMutation(updateProject)\n    const { refetch } = useQuery(getProjectWithUsersAndWorkorders, {}, () => ({\n      fetchPolicy: 'network-only',\n      enabled: queryEnabled.value\n    }))\n    const handleUpdateProject = async () => {\n      try {\n        isWorking.value = true\n        queryEnabled.value = true\n        // eslint-disable-next-line\n        await mutate({ project: projectUpdateDTO } as any)\n        const res = await refetch()\n        if (res.data) {\n          console.log(res.data)\n          mutations.setProject(res.data.getProjectWithUsersAndWorkorders)\n        }\n        successToast('Changes have been saved successfully.').showToast()\n        isWorking.value = false\n      } catch (error) {\n        isWorking.value = false\n        errorToast('An error has occurred').showToast()\n      }\n    }\n    return {\n      project,\n      isWorking,\n      projectUpdateDTO,\n      handleUpdateProject,\n      isValid,\n      projectCategoryOptions\n    }\n  }\n})\n</script>\n\n<style lang=\"postcss\" scoped>\n.label {\n  @apply pb-2 font-medium text-13 text-textMedium block;\n}\n.tip {\n  @apply pt-1-5 text-textMedium text-13;\n}\n</style>\n"]}]}