{"remainingRequest":"/home/ash/Documents/cloudrun/second/frontend/node_modules/babel-loader/lib/index.js!/home/ash/Documents/cloudrun/second/frontend/node_modules/ts-loader/index.js??ref--14-2!/home/ash/Documents/cloudrun/second/frontend/node_modules/eslint-loader/index.js??ref--13-0!/home/ash/Documents/cloudrun/second/frontend/src/router.ts","dependencies":[{"path":"/home/ash/Documents/cloudrun/second/frontend/src/router.ts","mtime":1601934213289},{"path":"/home/ash/Documents/cloudrun/second/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ash/Documents/cloudrun/second/frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/ash/Documents/cloudrun/second/frontend/node_modules/ts-loader/index.js","mtime":499162500000},{"path":"/home/ash/Documents/cloudrun/second/frontend/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc29tZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiL2hvbWUvYXNoL0RvY3VtZW50cy9jbG91ZHJ1bi9zZWNvbmQvZnJvbnRlbmQvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgVnVlIGZyb20gJ3Z1ZSc7CmltcG9ydCBWdWVSb3V0ZXIgZnJvbSAndnVlLXJvdXRlcic7CmltcG9ydCBzdG9yZSBmcm9tICdAL3N0b3JlJzsKaW1wb3J0IHsgYXV0aGVudGljYXRlIH0gZnJvbSAnQC9hdXRoL2F1dGhlbnRpY2F0ZSc7CmltcG9ydCB7IGZldGNoTWUgfSBmcm9tICdAL2dyYXBocWwvcXVlcmllcy9hdXRoJzsKVnVlLnVzZShWdWVSb3V0ZXIpOwoKZnVuY3Rpb24gbG9hZFZpZXcodmlldykgewogIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gaW1wb3J0KAogICAgLyogd2VicGFja0NodW5rTmFtZTogInZpZXctW3JlcXVlc3RdIiAqLwogICAgIkAvdmlld3MvIi5jb25jYXQodmlldywgIi52dWUiKSk7CiAgfTsKfQoKdmFyIHJvdXRlcyA9IFt7CiAgcGF0aDogJy8nLAogIG5hbWU6ICdyb290JywKICByZWRpcmVjdDogJ3Byb2plY3QnCn0sIHsKICBwYXRoOiAnL3Byb2plY3QnLAogIG1ldGE6IHsKICAgIHJlcXVpcmVzQXV0aDogdHJ1ZQogIH0sCiAgY29tcG9uZW50OiBsb2FkVmlldygnUHJvamVjdC9Qcm9qZWN0JyksCiAgY2hpbGRyZW46IFt7CiAgICBwYXRoOiAnJywKICAgIG5hbWU6ICdib2FyZCcsCiAgICBjb21wb25lbnQ6IGxvYWRWaWV3KCdQcm9qZWN0L0JvYXJkJykKICB9LCB7CiAgICBwYXRoOiAnc2V0dGluZ3MnLAogICAgbmFtZTogJ3NldHRpbmdzJywKICAgIGNvbXBvbmVudDogbG9hZFZpZXcoJ1Byb2plY3QvU2V0dGluZ3MnKQogIH0sIHsKICAgIHBhdGg6ICd3b3Jrb3JkZXIvOndvcmtvcmRlcklkJywKICAgIG5hbWU6ICd3b3Jrb3JkZXInLAogICAgY29tcG9uZW50OiBsb2FkVmlldygnUHJvamVjdC9GdWxsSXdvcmtvcmRlckRldGFpbHMnKSwKICAgIHByb3BzOiB0cnVlCiAgfV0KfV07CnZhciByb3V0ZXIgPSBuZXcgVnVlUm91dGVyKHsKICBtb2RlOiAnaGlzdG9yeScsCiAgYmFzZTogcHJvY2Vzcy5lbnYuQkFTRV9VUkwsCiAgcm91dGVzOiByb3V0ZXMKfSk7CnJvdXRlci5iZWZvcmVFYWNoKCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIHZhciBfcmVmID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKHRvLCBfLCBuZXh0KSB7CiAgICB2YXIgY3VycmVudFVzZXI7CiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIGlmICghdG8ubWF0Y2hlZC5zb21lKGZ1bmN0aW9uIChyb3V0ZVJlY29yZCkgewogICAgICAgICAgICAgIHJldHVybiByb3V0ZVJlY29yZC5tZXRhLnJlcXVpcmVzQXV0aDsKICAgICAgICAgICAgfSkpIHsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjM7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChzdG9yZS5nZXR0ZXJzLmlzQXV0aGVudGljYXRlZCgpKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDc7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA0OwogICAgICAgICAgICByZXR1cm4gYXV0aGVudGljYXRlKCk7CgogICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICBuZXh0KHsKICAgICAgICAgICAgICBuYW1lOiB0by5uYW1lIHx8ICdyb290JwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDIxOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSA3OwogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTA7CiAgICAgICAgICAgIHJldHVybiBmZXRjaE1lKCk7CgogICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgY3VycmVudFVzZXIgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICBzdG9yZS5tdXRhdGlvbnMuc2V0Q3VycmVudFVzZXIoY3VycmVudFVzZXIpOwogICAgICAgICAgICBuZXh0KCk7CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyMTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDE1OwogICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDcpOwoKICAgICAgICAgICAgaWYgKCEoX2NvbnRleHQudDAubWVzc2FnZSA9PT0gJ0dyYXBoUUwgZXJyb3I6IEF1dGhlbnRpY2F0aW9uIHRva2VuIGlzIGludmFsaWQ6IFVzZXIgbm90IGZvdW5kLicgfHwgX2NvbnRleHQudDAubWVzc2FnZSA9PT0gJ0dyYXBoUUwgZXJyb3I6IEF1dGhlbnRpY2F0aW9uIHRva2VuIGlzIGludmFsaWQuJykpIHsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjE7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyMDsKICAgICAgICAgICAgcmV0dXJuIGF1dGhlbnRpY2F0ZSgpOwoKICAgICAgICAgIGNhc2UgMjA6CiAgICAgICAgICAgIG5leHQoewogICAgICAgICAgICAgIG5hbWU6IHRvLm5hbWUgfHwgJ3Jvb3QnCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgIGNhc2UgMjE6CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyNDsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAyMzoKICAgICAgICAgICAgbmV4dCgpOwoKICAgICAgICAgIGNhc2UgMjQ6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZSwgbnVsbCwgW1s3LCAxNV1dKTsKICB9KSk7CgogIHJldHVybiBmdW5jdGlvbiAoX3gsIF94MiwgX3gzKSB7CiAgICByZXR1cm4gX3JlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogIH07Cn0oKSk7CmV4cG9ydCBkZWZhdWx0IHJvdXRlcjs="},{"version":3,"sources":["/home/ash/Documents/cloudrun/second/frontend/node_modules/eslint-loader/index.js??ref--13-0!/home/ash/Documents/cloudrun/second/frontend/src/router.ts"],"names":[],"mappings":";;;;;AAAA,OAAO,GAAP,MAAgB,KAAhB;AACA,OAAO,SAAP,MAAuC,YAAvC;AACA,OAAO,KAAP,MAAkB,SAAlB;AACA,SAAS,YAAT,QAA6B,qBAA7B;AACA,SAAS,OAAT,QAAwB,wBAAxB;AAEA,GAAG,CAAC,GAAJ,CAAQ,SAAR;;AAEA,SAAS,QAAT,CAAkB,IAAlB,EAA8B;AAC5B,SAAO;AAAA,WACL;AAAO;AAAP,sBAA2D,IAA3D,UADK;AAAA,GAAP;AAED;;AAED,IAAM,MAAM,GAAkB,CAC5B;AACE,EAAA,IAAI,EAAE,GADR;AAEE,EAAA,IAAI,EAAE,MAFR;AAGE,EAAA,QAAQ,EAAE;AAHZ,CAD4B,EAM5B;AACE,EAAA,IAAI,EAAE,UADR;AAEE,EAAA,IAAI,EAAE;AAAE,IAAA,YAAY,EAAE;AAAhB,GAFR;AAGE,EAAA,SAAS,EAAE,QAAQ,CAAC,iBAAD,CAHrB;AAIE,EAAA,QAAQ,EAAE,CACR;AACE,IAAA,IAAI,EAAE,EADR;AAEE,IAAA,IAAI,EAAE,OAFR;AAGE,IAAA,SAAS,EAAE,QAAQ,CAAC,eAAD;AAHrB,GADQ,EAMR;AACE,IAAA,IAAI,EAAE,UADR;AAEE,IAAA,IAAI,EAAE,UAFR;AAGE,IAAA,SAAS,EAAE,QAAQ,CAAC,kBAAD;AAHrB,GANQ,EAWR;AACE,IAAA,IAAI,EAAE,wBADR;AAEE,IAAA,IAAI,EAAE,WAFR;AAGE,IAAA,SAAS,EAAE,QAAQ,CAAC,+BAAD,CAHrB;AAIE,IAAA,KAAK,EAAE;AAJT,GAXQ;AAJZ,CAN4B,CAA9B;AA+BA,IAAM,MAAM,GAAG,IAAI,SAAJ,CAAc;AAC3B,EAAA,IAAI,EAAE,SADqB;AAE3B,EAAA,IAAI,EAAE,OAAO,CAAC,GAAR,CAAY,QAFS;AAG3B,EAAA,MAAM,EAAN;AAH2B,CAAd,CAAf;AAMA,MAAM,CAAC,UAAP;AAAA,qEAAkB,iBAAO,EAAP,EAAW,CAAX,EAAc,IAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBACZ,EAAE,CAAC,OAAH,CAAW,IAAX,CAAgB,UAAA,WAAW;AAAA,qBAAI,WAAW,CAAC,IAAZ,CAAiB,YAArB;AAAA,aAA3B,CADY;AAAA;AAAA;AAAA;;AAAA,gBAET,KAAK,CAAC,OAAN,CAAc,eAAd,EAFS;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAGN,YAAY,EAHN;;AAAA;AAIZ,YAAA,IAAI,CAAC;AAAE,cAAA,IAAI,EAAE,EAAE,CAAC,IAAH,IAAW;AAAnB,aAAD,CAAJ;AAJY;AAAA;;AAAA;AAAA;AAAA;AAAA,mBAOgB,OAAO,EAPvB;;AAAA;AAOJ,YAAA,WAPI;AAQV,YAAA,KAAK,CAAC,SAAN,CAAgB,cAAhB,CAA+B,WAA/B;AACA,YAAA,IAAI;AATM;AAAA;;AAAA;AAAA;AAAA;;AAAA,kBAYR,YAAM,OAAN,KACE,iEADF,IAEA,YAAM,OAAN,KAAkB,iDAdV;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAgBF,YAAY,EAhBV;;AAAA;AAiBR,YAAA,IAAI,CAAC;AAAE,cAAA,IAAI,EAAE,EAAE,CAAC,IAAH,IAAW;AAAnB,aAAD,CAAJ;;AAjBQ;AAAA;AAAA;;AAAA;AAsBd,YAAA,IAAI;;AAtBU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAlB;;AAAA;AAAA;AAAA;AAAA;AA0BA,eAAe,MAAf","sourcesContent":["import Vue from 'vue'\nimport VueRouter, { RouteConfig } from 'vue-router'\nimport store from '@/store'\nimport { authenticate } from '@/auth/authenticate'\nimport { fetchMe } from '@/graphql/queries/auth'\n\nVue.use(VueRouter)\n\nfunction loadView(view: string) {\n  return () =>\n    import(/* webpackChunkName: \"view-[request]\" */ `@/views/${view}.vue`)\n}\n\nconst routes: RouteConfig[] = [\n  {\n    path: '/',\n    name: 'root',\n    redirect: 'project'\n  },\n  {\n    path: '/project',\n    meta: { requiresAuth: true },\n    component: loadView('Project/Project'),\n    children: [\n      {\n        path: '',\n        name: 'board',\n        component: loadView('Project/Board')\n      },\n      {\n        path: 'settings',\n        name: 'settings',\n        component: loadView('Project/Settings')\n      },\n      {\n        path: 'workorder/:workorderId',\n        name: 'workorder',\n        component: loadView('Project/FullIworkorderDetails'),\n        props: true\n      }\n    ]\n  }\n]\n\nconst router = new VueRouter({\n  mode: 'history',\n  base: process.env.BASE_URL,\n  routes\n})\n\nrouter.beforeEach(async (to, _, next) => {\n  if (to.matched.some(routeRecord => routeRecord.meta.requiresAuth)) {\n    if (!store.getters.isAuthenticated()) {\n      await authenticate()\n      next({ name: to.name || 'root' })\n    } else {\n      try {\n        const currentUser = await fetchMe()\n        store.mutations.setCurrentUser(currentUser)\n        next()\n      } catch (error) {\n        if (\n          error.message ===\n            'GraphQL error: Authentication token is invalid: User not found.' ||\n          error.message === 'GraphQL error: Authentication token is invalid.'\n        ) {\n          await authenticate()\n          next({ name: to.name || 'root' })\n        }\n      }\n    }\n  } else {\n    next()\n  }\n})\n\nexport default router\n"],"sourceRoot":""}]}