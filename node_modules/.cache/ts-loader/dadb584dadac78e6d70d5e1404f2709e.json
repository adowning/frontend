{"remainingRequest":"/home/ash/Documents/cloudrun/second/frontend/node_modules/babel-loader/lib/index.js!/home/ash/Documents/cloudrun/second/frontend/node_modules/ts-loader/index.js??ref--15-2!/home/ash/Documents/cloudrun/second/frontend/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/ash/Documents/cloudrun/second/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ash/Documents/cloudrun/second/frontend/src/components/Project/Workorder/WorkorderSearch/WorkorderSearch.vue?vue&type=script&lang=tsx&","dependencies":[{"path":"/home/ash/Documents/cloudrun/second/frontend/src/components/Project/Workorder/WorkorderSearch/WorkorderSearch.vue","mtime":1601935310559},{"path":"/home/ash/Documents/cloudrun/second/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ash/Documents/cloudrun/second/frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/ash/Documents/cloudrun/second/frontend/node_modules/ts-loader/index.js","mtime":499162500000},{"path":"/home/ash/Documents/cloudrun/second/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ash/Documents/cloudrun/second/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc2xpY2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcudHJpbSI7CmltcG9ydCB7IGRlZmluZUNvbXBvbmVudCwgcmVmLCBjb21wdXRlZCwgb25Nb3VudGVkIH0gZnJvbSAnQHZ1ZS9jb21wb3NpdGlvbi1hcGknOwppbXBvcnQgU2VhcmNoUmVzdWx0IGZyb20gJy4vU2VhcmNoUmVzdWx0LnZ1ZSc7CmltcG9ydCBMb2FkZXIgZnJvbSAnQC9jb21wb25lbnRzL0xvYWRlci52dWUnOwppbXBvcnQgeyB1c2VRdWVyeSwgdXNlUmVzdWx0IH0gZnJvbSAnQHZ1ZS9hcG9sbG8tY29tcG9zYWJsZSc7CmltcG9ydCB7IGdldFByb2plY3RXb3Jrb3JkZXJzIH0gZnJvbSAnQC9ncmFwaHFsL3F1ZXJpZXMvd29ya29yZGVyJzsKaW1wb3J0IHsgZ2V0dGVycyB9IGZyb20gJ0Avc3RvcmUnOwppbXBvcnQgeyBkZWJvdW5jZSB9IGZyb20gJ3Rocm90dGxlLWRlYm91bmNlJzsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lCgp2YXIgc29ydEJ5TmV3ZXN0ID0gZnVuY3Rpb24gc29ydEJ5TmV3ZXN0KCkgewogIHZhciBpdGVtcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogW107CiAgdmFyIHNvcnRGaWVsZCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkOwogIHJldHVybiBpdGVtcy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7CiAgICByZXR1cm4gLWFbc29ydEZpZWxkXS5sb2NhbGVDb21wYXJlKGJbc29ydEZpZWxkXSk7CiAgfSk7Cn07CgpleHBvcnQgZGVmYXVsdCBkZWZpbmVDb21wb25lbnQoewogIGNvbXBvbmVudHM6IHsKICAgIFNlYXJjaFJlc3VsdDogU2VhcmNoUmVzdWx0LAogICAgU3Bpbm5lcjogTG9hZGVyCiAgfSwKICBzZXR1cDogZnVuY3Rpb24gc2V0dXAoKSB7CiAgICB2YXIgaXNTZWFyY2hUZXJtRW1wdHkgPSByZWYodHJ1ZSk7CiAgICB2YXIgc2VhcmNoVGVybSA9IHJlZignJyk7CiAgICB2YXIgc2VhcmNoSW5wdXRSZWYgPSByZWYobnVsbCk7CgogICAgdmFyIF91c2VRdWVyeSA9IHVzZVF1ZXJ5KGdldFByb2plY3RXb3Jrb3JkZXJzLCB7CiAgICAgIHNlYXJjaFRlcm06IHNlYXJjaFRlcm0udmFsdWUKICAgIH0pLAogICAgICAgIHJlc3VsdCA9IF91c2VRdWVyeS5yZXN1bHQsCiAgICAgICAgcmVmZXRjaCA9IF91c2VRdWVyeS5yZWZldGNoLAogICAgICAgIGxvYWRpbmcgPSBfdXNlUXVlcnkubG9hZGluZzsKCiAgICB2YXIgcHJvamVjdCA9IGNvbXB1dGVkKGdldHRlcnMucHJvamVjdCk7CiAgICB2YXIgbWF0Y2hpbmd3b3Jrb3JkZXJzID0gdXNlUmVzdWx0KHJlc3VsdCwgW10pOwogICAgdmFyIHJlY2VudHdvcmtvcmRlcnMgPSBjb21wdXRlZChmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBzb3J0QnlOZXdlc3QocHJvamVjdC52YWx1ZS53b3Jrb3JkZXJzLCAnY3JlYXRlZEF0Jykuc2xpY2UoMCwgMTApOwogICAgfSk7CiAgICB2YXIgaGFuZGxlU2VhcmNoQ2hhbmdlID0gZGVib3VuY2UoNTAwLCBmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgc2VhcmNoVGVybS52YWx1ZSA9IHZhbHVlLnRyaW0oKTsKICAgICAgaXNTZWFyY2hUZXJtRW1wdHkudmFsdWUgPSAhc2VhcmNoVGVybS52YWx1ZTsKCiAgICAgIGlmIChzZWFyY2hUZXJtLnZhbHVlKSB7CiAgICAgICAgcmVmZXRjaCh7CiAgICAgICAgICBzZWFyY2hUZXJtOiBzZWFyY2hUZXJtLnZhbHVlCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0pOwogICAgb25Nb3VudGVkKGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKHNlYXJjaElucHV0UmVmLnZhbHVlKSB7CiAgICAgICAgdmFyIGlucHV0RWwgPSBzZWFyY2hJbnB1dFJlZi52YWx1ZS4kZWwucXVlcnlTZWxlY3RvcignaW5wdXQnKTsKCiAgICAgICAgaWYgKGlucHV0RWwpIHsKICAgICAgICAgIGlucHV0RWwuZm9jdXMoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0pOwogICAgcmV0dXJuIHsKICAgICAgbWF0Y2hpbmd3b3Jrb3JkZXJzOiBtYXRjaGluZ3dvcmtvcmRlcnMsCiAgICAgIGxvYWRpbmc6IGxvYWRpbmcsCiAgICAgIHJlY2VudHdvcmtvcmRlcnM6IHJlY2VudHdvcmtvcmRlcnMsCiAgICAgIGlzU2VhcmNoVGVybUVtcHR5OiBpc1NlYXJjaFRlcm1FbXB0eSwKICAgICAgaGFuZGxlU2VhcmNoQ2hhbmdlOiBoYW5kbGVTZWFyY2hDaGFuZ2UsCiAgICAgIHNlYXJjaFRlcm06IHNlYXJjaFRlcm0sCiAgICAgIHNlYXJjaElucHV0UmVmOiBzZWFyY2hJbnB1dFJlZgogICAgfTsKICB9Cn0pOw=="},{"version":3,"sources":["/home/ash/Documents/cloudrun/second/frontend/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/ash/Documents/cloudrun/second/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ash/Documents/cloudrun/second/frontend/src/components/Project/Workorder/WorkorderSearch/WorkorderSearch.vue?vue&type=script&lang=tsx&"],"names":[],"mappings":";;AAmDA,SAAS,eAAT,EAA0B,GAA1B,EAA+B,QAA/B,EAAyC,SAAzC,QAA0D,sBAA1D;AACA,OAAO,YAAP,MAAyB,oBAAzB;AACA,OAAO,MAAP,MAAmB,yBAAnB;AACA,SAAS,QAAT,EAAmB,SAAnB,QAAoC,wBAApC;AACA,SAAS,oBAAT,QAAqC,6BAArC;AAEA,SAAS,OAAT,QAAwB,SAAxB;AACA,SAAS,QAAT,QAAyB,mBAAzB,C,CAEA;;AACA,IAAM,YAAY,GAAG,SAAf,YAAe;AAAA,MAAC,KAAD,uEAAgB,EAAhB;AAAA,MAAoB,SAApB;AAAA,SACnB,KAAK,CAAC,IAAN,CAAW,UAAC,CAAD,EAAI,CAAJ;AAAA,WAAU,CAAC,CAAC,CAAC,SAAD,CAAD,CAAa,aAAb,CAA2B,CAAC,CAAC,SAAD,CAA5B,CAAX;AAAA,GAAX,CADmB;AAAA,CAArB;;AAGA,eAAe,eAAe,CAAC;AAC7B,EAAA,UAAU,EAAE;AACV,IAAA,YAAY,EAAZ,YADU;AAEV,IAAA,OAAO,EAAE;AAFC,GADiB;AAK7B,EAAA,KAL6B,mBAKxB;AACH,QAAM,iBAAiB,GAAG,GAAG,CAAU,IAAV,CAA7B;AACA,QAAM,UAAU,GAAG,GAAG,CAAS,EAAT,CAAtB;AACA,QAAM,cAAc,GAAG,GAAG,CAExB,IAFwB,CAA1B;;AAHG,oBAMkC,QAAQ,CAC3C,oBAD2C,EAE3C;AACE,MAAA,UAAU,EAAE,UAAU,CAAC;AADzB,KAF2C,CAN1C;AAAA,QAMK,MANL,aAMK,MANL;AAAA,QAMa,OANb,aAMa,OANb;AAAA,QAMsB,OANtB,aAMsB,OANtB;;AAaH,QAAM,OAAO,GAAG,QAAQ,CAAC,OAAO,CAAC,OAAT,CAAxB;AAEA,QAAM,kBAAkB,GAAG,SAAS,CAAC,MAAD,EAAS,EAAT,CAApC;AACA,QAAM,gBAAgB,GAAG,QAAQ,CAAC;AAAA,aAChC,YAAY,CAAC,OAAO,CAAC,KAAR,CAAc,UAAf,EAA2B,WAA3B,CAAZ,CAAoD,KAApD,CAA0D,CAA1D,EAA6D,EAA7D,CADgC;AAAA,KAAD,CAAjC;AAIA,QAAM,kBAAkB,GAAG,QAAQ,CAAC,GAAD,EAAM,UAAC,KAAD,EAAkB;AACzD,MAAA,UAAU,CAAC,KAAX,GAAmB,KAAK,CAAC,IAAN,EAAnB;AACA,MAAA,iBAAiB,CAAC,KAAlB,GAA0B,CAAC,UAAU,CAAC,KAAtC;;AACA,UAAI,UAAU,CAAC,KAAf,EAAsB;AACpB,QAAA,OAAO,CAAC;AAAE,UAAA,UAAU,EAAE,UAAU,CAAC;AAAzB,SAAD,CAAP;AACD;AACF,KANkC,CAAnC;AAQA,IAAA,SAAS,CAAC,YAAK;AACb,UAAI,cAAc,CAAC,KAAnB,EAA0B;AACxB,YAAM,OAAO,GAAG,cAAc,CAAC,KAAf,CAAqB,GAArB,CAAyB,aAAzB,CAAuC,OAAvC,CAAhB;;AACA,YAAI,OAAJ,EAAa;AACX,UAAA,OAAO,CAAC,KAAR;AACD;AACF;AACF,KAPQ,CAAT;AASA,WAAO;AACL,MAAA,kBAAkB,EAAlB,kBADK;AAEL,MAAA,OAAO,EAAP,OAFK;AAGL,MAAA,gBAAgB,EAAhB,gBAHK;AAIL,MAAA,iBAAiB,EAAjB,iBAJK;AAKL,MAAA,kBAAkB,EAAlB,kBALK;AAML,MAAA,UAAU,EAAV,UANK;AAOL,MAAA,cAAc,EAAd;AAPK,KAAP;AASD;AAnD4B,CAAD,CAA9B","sourcesContent":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { defineComponent, ref, computed, onMounted } from '@vue/composition-api'\nimport SearchResult from './SearchResult.vue'\nimport Loader from '@/components/Loader.vue'\nimport { useQuery, useResult } from '@vue/apollo-composable'\nimport { getProjectWorkorders } from '@/graphql/queries/workorder'\nimport { Workorder } from '@/types/workorder'\nimport { getters } from '@/store'\nimport { debounce } from 'throttle-debounce'\nimport { CombinedVueInstance } from 'vue/types/vue'\n// eslint-disable-next-line\nconst sortByNewest = (items: any[] = [], sortField: string) =>\n  items.sort((a, b) => -a[sortField].localeCompare(b[sortField]))\n\nexport default defineComponent({\n  components: {\n    SearchResult,\n    Spinner: Loader\n  },\n  setup() {\n    const isSearchTermEmpty = ref<boolean>(true)\n    const searchTerm = ref<string>('')\n    const searchInputRef = ref<\n      CombinedVueInstance<Vue, object, object, object, object>\n    >(null)\n    const { result, refetch, loading } = useQuery<Workorder[]>(\n      getProjectWorkorders,\n      {\n        searchTerm: searchTerm.value\n      }\n    )\n\n    const project = computed(getters.project)\n\n    const matchingworkorders = useResult(result, [])\n    const recentworkorders = computed(() =>\n      sortByNewest(project.value.workorders, 'createdAt').slice(0, 10)\n    )\n\n    const handleSearchChange = debounce(500, (value: string) => {\n      searchTerm.value = value.trim()\n      isSearchTermEmpty.value = !searchTerm.value\n      if (searchTerm.value) {\n        refetch({ searchTerm: searchTerm.value })\n      }\n    })\n\n    onMounted(() => {\n      if (searchInputRef.value) {\n        const inputEl = searchInputRef.value.$el.querySelector('input')\n        if (inputEl) {\n          inputEl.focus()\n        }\n      }\n    })\n\n    return {\n      matchingworkorders,\n      loading,\n      recentworkorders,\n      isSearchTermEmpty,\n      handleSearchChange,\n      searchTerm,\n      searchInputRef\n    }\n  }\n})\n"],"sourceRoot":""}]}